### 1. 프로젝트 개요

- **프로젝트명:** Browser Helper
- **목표:** 사용자가 현재 보고 있는 웹페이지의 내용을 기반으로 AI와 자유롭게 대화하며 원하는 형태로 정보를 요약하고 질문할 수 있는 크롬 익스텐션을 개발한다.

### 2. 주요 기능 명세 (Core Features)

### A. 페이지 컨텍스트 자동 인식 및 채팅

- **트리거:** 사용자가 브라우저 툴바의 익스텐션 아이콘을 클릭하여 팝업을 연다.
- **동작:**
  1. 익스텐션이 열리는 즉시, 현재 활성화된 탭의 HTML 콘텐츠를 읽어온다.
  2. HTML에서 **단순 텍스트(Simple Text)만 추출**하여 내부 변수에 저장한다.
  3. 사용자가 채팅창에 메시지를 입력하고 전송하면, 저장된 **페이지 텍스트와 사용자 메시지를 함께** OpenAI API로 전송한다.
- **UI:** 대화형 채팅 UI (채팅 기록, 입력창)

### B. API 키 관리

- **입력:** 익스텐션 팝업 최상단에 API 키를 입력할 수 있는 텍스트 필드를 배치한다.
- **유효성 검사:** API 키가 입력되지 않은 상태에서는 채팅 메시지 전송이 비활성화되거나, 전송 시도를 막고 키 입력을 요청하는 메시지를 표시한다.
- **저장:** 입력된 API 키는 사용자의 브라우저 로컬 스토리지(`chrome.storage.local`)에 안전하게 저장하여 재사용할 수 있도록 한다.

### C. 동적 요약 및 질의응답

- 사전 정의된 요약 옵션(예: 3줄 요약)은 제공하지 않는다.
- 사용자가 채팅을 통해 "이 페이지 3줄로 요약해줘", "핵심 키워드가 뭐야?", "이 글의 저자에 대해 알려줘" 등과 같이 **요구하는 내용에 맞춰** AI가 페이지 컨텍스트를 기반으로 동적으로 답변을 생성한다.

### 3. UI/UX 명세

### A. 기본 레이아웃

- **상단:** OpenAI API 키를 입력하는 단일 라인 입력 필드.
- **중단:** 사용자와 AI 간의 대화가 표시되는 채팅 기록 영역.
- **하단:** 사용자가 메시지를 입력하는 텍스트 입력창과 '전송' 버튼.

### B. 사용자 플로우 (User Flow)

1. 사용자가 익스텐션 아이콘을 클릭한다.
2. (최초 실행 시) 최상단 입력창에 자신의 OpenAI API 키를 붙여넣는다.
3. 익스텐션은 백그라운드에서 현재 페이지의 텍스트를 자동으로 로드한다.
4. 사용자가 하단 입력창에 "이 페이지 내용 요약해줘"라고 입력하고 '전송' 버튼을 누른다.
5. 사용자가 보낸 메시지가 채팅창에 표시되고, AI의 응답을 기다리는 동안 **GPT 채팅 대기 UI (로딩 인디케이터 등)**가 표시된다.
6. API로부터 응답이 오면, AI의 답변(요약 내용)이 채팅창에 새로운 메시지로 나타난다.

### 4. 기술 요구사항

- **플랫폼:** 크롬 브라우저 익스텐션 (Manifest V3)
- **사용 언어:** HTML, CSS, JavaScript
- **API:** OpenAI API
- **AI 모델:** **`gpt-5-nano`**

### 5. 예외 처리 (Error Handling)

- 모든 오류 상황은 시스템 메시지가 아닌, **AI 에이전트가 대답하는 형식**으로 채팅창에 자연스럽게 표시한다.
  - **API 키가 잘못되었을 경우:**
    > "입력하신 API 키가 유효하지 않은 것 같아요. 상단의 입력창에서 키를 다시 한번 확인해 주시겠어요?"
  - **네트워크 오류 발생 시:**
    > "죄송합니다, 지금 네트워크에 연결할 수 없어 답변을 드릴 수 없어요. 잠시 후 다시 시도해 주세요."
  - **페이지에 텍스트가 없는 경우:**
    > "이 페이지에서는 요약할 만한 텍스트를 찾지 못했어요. 다른 텍스트가 많은 페이지에서 시도해 보시겠어요?"
